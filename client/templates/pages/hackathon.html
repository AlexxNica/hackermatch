<template name="hackathonNav">
    <h1>{{selected_hackathon.url_title}}</h1>
      <ul>
          <li>
              <a id="find-ideas-link" href="/{{selected_hackathon.url_title}}/ideas">Ideas
              </a>
          </li>
          <li>
              <a id="find-teams-link" href="/{{selected_hackathon.url_title}}/hackers">
              People
              </a>
          </li>
          <li>
              <a id="" href="/{{selected_hackathon.url_title}}/ideas/new">
              Add Idea
              </a>
          </li>
      </ul>
</template>

<template name="hackathon">
    {{> hackathonNav}}
    {{> profile_sidebar}}
    {{> sidebar}} <!-- This is the comments sidebar -->
    <div class="container">
        {{#if isInRole 'hacker' url_title}}
            {{> showHackathons}}
        {{else}}
            <div class="row label">
                You have not joined this hackathon
            </div>
        {{/if}}
    </div>
</template>

<template name="profile_sidebar">
    <div class="profile_sidebar" style="{{#if opened}}{{else}}display:none;{{/if}}" >
        {{#if profile.avatar_url}}
            <img src="{{idea.author.profile.avatar_url}}" class="sidebar-profile-avatar">
        {{/if}}
        <div class="sidebar-item-title">
            <h1>{{profile.name}}</h1>
        </div>
        <div class="profile-skills">
            {{#if skills }}
                {{#each bitmaparray skills}}
                    <span class="badge {{.}}">{{.}}</span> 
                {{/each}}
            {{/if}}
        </div>
        <div class="user-details"> 
            <span class="sidebar-item-contact">
            {{#if idea.author.profile.contact}}
                contact <a href="mailto:{{idea.author.profile.contact}}">{{idea.author.profile.contact}}</a>
            {{/if}}
            </span> 
            <span>
              {{#if languages }}
                {{languages}}
              {{/if}}
            </span>
            <span>
            {{#if github }}
              <a href="{{github_url}}"><i class="fa fa-github"></i>{{github}}</a>
            {{/if}}
            </span>
            <span>
              {{#if contact }}
                <i class="fa fa-paper-plane-o"></i>
                {{contact}}
              {{/if}}
            </span>
            <span>
              {{#if location }}
                <i class="fa fa-map-marker"></i>
                {{location}}
              {{/if}}
            </span>
        </div>
        <div class="">
          <span class="user-title">Worked on</span>
          {{#each featured}}
            <a href="{{html_url}}">{{stargazers_count}} <i class="fa fa-star"></i> <span class="feature-title">{{full_name}}</span>
            </a><br/>   
          {{/each}}
        </div>
        <div class="">
          <span class="user-title">People worked with</span>
          {{#each sortandarrayify collaborators}}
            <div class="collaborator">
            <a href="{{f_html_url}}"><img src="{{f_avatar_url}}" class="mini-avatar"><span class="feature-title">{{f_login}}</span>
            </a></div>
          {{/each}}
        </div>
    </div>
</template>

<template name="idea_list">
    {{#each ideas}}    
        {{> ideaRow }}
    {{/each}}
</template>

<template name="ideaRow">
    <ul class="row item idea-list cf">
        <li data-id="{{_id}}" class="item-action item-heart">
            <i class="ion-heart btn btn-icon-only icon-star {{#if hearted}}hearted{{/if}}"></i>
            <span class="item-hearts">{{len hearts}}</span>
        </li>
        <li data-id="{{_id}}" class="item-text">
        	<span class="item-title">{{name}}</span>
        	<span class="item-desc">{{description}}</span>
        	<br/>
            <span class="item-skills">
                <span class="skill_tag">Looking for:</span>
        	    {{#if skills.webdev}}
        	    <span class="badge t1">Frontend</span>
        	    {{/if}}
        	    {{#if skills.design}}
        	    <span class="badge t2">Design</span>
        	    {{/if}}
        	    {{#if skills.backend}}
        	    <span class="badge t3">Backend</span>
        	    {{/if}}
        	    {{#if skills.hardware}}
        	    <span class="badge t4">Hardware</span>
        	    {{/if}}
        	    {{#if skills.mobile}}
        	    <span class="badge t5">Mobile</span>
        	    {{/if}}
        	</span>
            <span class="item-comments">
            {{#if positive commentCount}}
                {{commentCount}}
                <i class="fa fa-comment"></i>
            {{/if}}
            </span>
        </li>
        <li class="item-icon" style="float:right;">
            {{#if user_profile.avatar_url}}
            <a href="/user/{{user_profile.login}}"><img src="{{user_profile.avatar_url}}" width="64px" height="64px" style="border-radius:50px"></a>
            {{else}}
            <img src="monkey.png" width="64px" height="64px" style="border-radius:50px;">
            {{/if}}
        </li>
    </ul>
</template>

<template name="sidebar">
    <div class="sidebar" style="{{#if opened}}{{else}}display:none;{{/if}}" >
        <div id="sidebar-exit"><i class="fa fa-times"></i></div>
        <div class="sidebar-item-author">
            posted by 
            {{#if idea.user_profile.avatar_url}}
            <a href="/user/{{idea.user_profile.login}}" style="margin-left:10px"><img src="{{idea.user_profile.avatar_url}}" width="32px" height="32px" style="border-radius:50px;margin-top:-5px"></a>
            {{/if}}
            <a href="/user/{{idea.user_profile.login}}">{{idea.user_profile.name}}</a>
            {{toMoment time}}
        </div>
        <div class="sidebar-item-title"><h1>{{idea.name}}</h1></div>
        <div class="sidebar-item-desc">{{idea.description}}</div>
        {{#if anyTrue idea.skills}}
            <div class="sidebar-item-skills">
                <span class="sidebar-prompt">Looking for people with </span>

                {{#if idea.skills.webdev}}
                <span class="badge t1">Frontend</span>
                {{/if}}
                {{#if idea.skills.design}}
                <span class="badge t2">Design</span>
                {{/if}}
                {{#if idea.skills.backend}}
                <span class="badge t3">Backend</span>
                {{/if}}
                {{#if idea.skills.hardware}}
                <span class="badge t4">Hardware</span>
                {{/if}}
                {{#if idea.skills.mobile}}
                <span class="badge t5">Mobile</span>
                {{/if}}
                <span class="sidebar-prompt"> skills</span>  
    	   </div>
        {{/if}}
        <br/>
        <div class="sidebar-interested">
        Hearted by:
        {{#each idea.hearts}}
        <a href="/user/{{.}}">{{.}}</a>
        {{/each}}
        </div>
        <div class="sidebar-item-comments">
    	    <form id="comment-create" action="action" autocomplete="off">
                <input id="comment-text" type="text" placeholder="Discuss here">
    		    <input type="submit" value="Comment">
            </form>
            <div class="sidebar-item-comments-thread">
                {{#each reverse idea.commentThread}}    
                    {{> comment_template }}
                {{/each}}
    		</div>
        </div>
    </div>
</template>

<template name="comment_template">
	<div class="comment">
        <span class="comment-avatar">
            {{#if avatar_url}} 
            <a href="/user/{{login}}"><img src="{{avatar_url}}" width="48px" height="48px" style="border-radius:50px"></a>
            {{else}}
            <img src="monkey.png" width="48px" height="48px" style="border-radius:50px;">
            {{/if}}
        </span>
        <span class="comment-author"><a href="/user/{{login}}">{{#if username}}{{username}}{{else}}{{login}}{{/if}}</a></span>
        <span class="comment-skills">
            {{#if skills.webdev}}
            <span class="badge t1">Frontend</span>
            {{/if}}
            {{#if skills.design}}
            <span class="badge t2">Designer</span>
            {{/if}}
            {{#if skills.backend}}
            <span class="badge t3">Backend</span>
            {{/if}}
            {{#if skills.hardware}}
            <span class="badge t4">Hardware</span>
            {{/if}}
            {{#if skills.mobile}}
            <span class="badge t5">Mobile</span>
            {{/if}}  
        </span>
        <span class="comment-time">{{toMoment time}}</span>
        <!--        <span class="comment-skill"><span class="badge t1">W</span></span> -->
        <br/>
        <span class="comment-content">{{text}}</span>
	</div>
</template>

<template name="showHackathons">
    <div class="row label">
        {{> idea_filter }}
    </div>
    <div>
        {{> idea_list}} 
    </div>
</template>